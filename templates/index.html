<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>üß† Neuro Game ‚Äì Multimatem√°tica</title>
<style>
  :root {
    --bg1:#f0f2f5;
    --bg2:#e9ecef;
    --card:#ffffff;
    --accent:#007bff;
    --accent2:#0056b3;
    --muted:#6c757d;
    --good:#28a745;
    --bad:#dc3545;
    --text-color:#212529;
    --card-shadow:0 4px 12px rgba(0,0,0,0.1);
    --button-bg:#f8f9fa;
    --button-text:#212529;
  }
  * { box-sizing: border-box; }
  body {
    margin:0;
    font-family:Inter, Poppins, "Segoe UI", Roboto, sans-serif;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    color:var(--text-color);
    padding:20px;
  }
  header {
    display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap;
  }
  h1 {
    margin:6px 0;
    color:var(--accent);
  }
  .controls { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  button, .toggle, .muted-btn {
    cursor:pointer;
    border:1px solid var(--muted);
    padding:8px 12px;
    border-radius:10px;
    background:var(--button-bg);
    color:var(--button-text);
  }
  button:hover, .muted-btn:hover { opacity:0.9; background:var(--bg2); }
  .level-btn.active { background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#fff; border-color:var(--accent); }
  .container { display:grid; grid-template-columns:1fr 380px; gap:20px; margin-top:18px; }
  .card { background:var(--card); padding:18px; border-radius:12px; box-shadow:var(--card-shadow); color:var(--text-color); }
  .game-top { display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
  #areaAtual { font-size:18px; font-weight:600; color:var(--accent); }
  .question { font-size:26px; margin:14px 0; padding:14px; background:var(--button-bg); border-radius:10px; border:1px solid var(--bg2); color:var(--text-color); }
  .options { display:grid; grid-template-columns:repeat(5,1fr); gap:10px; }
  .option { padding:12px; border-radius:10px; background:var(--button-bg); border:2px solid var(--bg2); cursor:pointer; text-align:center; color:var(--text-color); }
  .option:hover { transform:translateY(-3px); transition:all .14s; background:var(--bg2); }
  .correct { background:var(--good); border-color:var(--good); color:#fff; }
  .wrong { background:var(--bad); border-color:var(--bad); color:#fff; }
  .meta { display:flex; gap:14px; align-items:center; flex-wrap:wrap; }
  #score { font-weight:700; }
  .stats { color:var(--muted); margin-top:10px; font-size:14px; }
  #chart { margin-top:12px; }
  .bar { height:12px; background:var(--bg2); border-radius:12px; margin:8px 0; overflow:hidden; border:1px solid var(--bg2); }
  .bar-fill { height:100%; background:linear-gradient(90deg,var(--accent),var(--accent2)); width:0; transition:width .4s; }
  aside .card { position:sticky; top:16px; }
  .study { font-size:14px; color:var(--muted); text-align:left; line-height:1.5; }
  .small { font-size:13px; color:var(--muted); }
  .row { display:flex; gap:10px; align-items:center; }
  .hint { margin-top:8px; background:var(--bg2); padding:10px; border-radius:8px; border:1px dashed var(--muted); min-height:38px; color:var(--text-color); }
  .diagram { margin-top:12px; display:flex; justify-content:center; }
  .center { display:flex; justify-content:center; align-items:center; }
  .muted-2 { color:var(--muted); }
  .badge { background:var(--bg2); padding:6px 8px; border-radius:8px; font-size:13px; color:var(--text-color); }
  @media(max-width:980px){.container{grid-template-columns:1fr;}}
</style>
</head>
<body>
<header>
  <div>
    <h1>üß† Neuro Game ‚Äì Multimatem√°tica</h1>
    <div class="small">Exerc√≠cios infinitos ‚Äî Painel de estudo separado (sem repeti√ß√£o)</div>
  </div>

  <div class="controls">
    <a href="https://cromosvirtual.com" class="muted-btn" style="text-decoration:none; display:flex; align-items:center; height:38px;">Voltar</a>
    <button id="zoomToggle" class="muted-btn">üîç</button>
    <div class="row">
      <button id="facilBtn" class="level-btn">Iniciante</button>
      <button id="medioBtn" class="level-btn">Intermedi√°rio</button>
      <button id="difBtn" class="level-btn">Avan√ßado</button>
    </div>
    <button id="studyToggle" class="muted-btn">Modo Estudo</button>
    <button id="clearOnlyErrors" class="muted-btn">Limpar erros</button>
    <button id="restartGame" class="muted-btn">Reiniciar</button>
  </div>
</header>

<div class="container">
  <main class="card">
    <div class="game-top">
      <div id="areaAtual">√Årea: ‚Äî</div>
      <div class="meta">
        <div id="score" class="badge">Pontua√ß√£o: 0</div>
        <div id="progress" class="small muted-2">0 acertos / 0 tentativas (0%)</div>
      </div>
    </div>

    <div id="question" class="question">Clique em um n√≠vel para come√ßar</div>

    <div id="options" class="options"></div>

    <div class="row" style="margin-top:12px; justify-content:space-between;">
      <div style="display:flex;gap:8px;">
        <button id="nextBtn" class="muted-btn">Pr√≥ximo</button>
        <button id="repeatBtn" class="muted-btn">Repetir √°rea</button>
      </div>
      <div style="display:flex;gap:8px;align-items:center;">
        <button id="explainBtn" class="muted-btn">Mostrar explica√ß√£o</button>
      </div>
    </div>

    <div id="hintBox" class="hint" style="display:none"></div>
    <div id="diagram" class="diagram" style="display:none"></div>

    <div class="stats">
      <div id="areaStats">Estat√≠sticas por √°rea: ‚Äî</div>
      <div id="recent" style="margin-top:6px;" class="small muted-2">Perguntas recentes evitam repeti√ß√£o</div>
    </div>
  </main>

  <aside>
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div style="font-weight:700">Painel de Estudo</div>
        <div class="small">F√≥rmulas essenciais (n√£o repetidas nas perguntas)</div>
      </div>

      <div id="studyPanel" class="study" style="margin-top:10px; display:none;">
        <b>√Ålgebra</b>
        <div>- x + 5 = 12 ‚Üí x = 7</div>
        <div>- (x + 2)(x - 3) = 0 ‚Üí x = -2 ou 3</div>
        <hr>
        <b>Geometria</b>
        <div>- √Årea c√≠rculo: A = œÄ r¬≤</div>
        <div>- Tri√¢ngulo: A = (b¬∑h)/2</div>
        <hr>
        <b>Trigonometria</b>
        <div>- sen30 = 1/2, sen45 ‚âà 0.71, sen60 ‚âà 0.87</div>
        <hr>
        <b>C√°lculo</b>
        <div>- d/dx x¬≤ = 2x</div>
        <div>- ‚à´ x‚Åø dx = x‚Åø‚Å∫¬π/(n+1) + C</div>
        <hr>
        <b>Estat√≠stica</b>
        <div>- M√©dia = soma/n</div>
        <div>- Moda: valor mais frequente; Mediana: valor central</div>
      </div>

      <div id="chart" style="margin-top:12px;"></div>

      <div style="margin-top:12px;">
        <div class="small">N√≠vel atual: <span id="levelLabel">‚Äî</span></div>
        <div style="margin-top:6px;" class="small">Alvo (Iniciante): <span id="easyTarget">3</span> acertos por √°rea</div>
      </div>

      <div style="margin-top:12px;" class="footer-note small muted-2">
        Nota: explica√ß√µes aparecem apenas quando voc√™ clicar em ‚ÄúMostrar explica√ß√£o‚Äù.
      </div>

      <div style="margin-top:12px;" class="small">
        <p>Doar Pix: 914e4b6a-91b4-4e50-bb7c-c610dc90407a</p>
        <p>Contato: contatoscromos@cromosvirtual.com</p>
      </div>
    </div>
  </aside>
</div>

<script>
/* ======= C√≥digo JavaScript mantido do seu jogo ======= */
const areas=["√Ålgebra","Geometria","Trigonometria","C√°lculo","Estat√≠stica"];
let currentArea=0, level='facil', score=0, studyMode=false, currentQ=null;
const stats={}, recentHashes=[], RECENT_MAX=60, easyTarget=3;
areas.forEach(a=>stats[a]={total:0, correct:0});

const d=id=>document.getElementById(id);
const questionDiv=d('question'), optionsDiv=d('options'), areaLabel=d('areaAtual');
const scoreLabel=d('score'), progressLabel=d('progress'), chart=d('chart'), areaStats=d('areaStats');
const hintBox=d('hintBox'), diagramDiv=d('diagram'), studyPanel=d('studyPanel');
const facilBtn=d('facilBtn'), medioBtn=d('medioBtn'), difBtn=d('difBtn');
const studyToggle=d('studyToggle'), clearOnlyErrors=d('clearOnlyErrors'), explainBtn=d('explainBtn');
const nextBtn=d('nextBtn'), repeatBtn=d('repeatBtn'), levelLabel=d('levelLabel');
const restartGame=d('restartGame'), zoomToggle=d('zoomToggle');

const randInt=(a,b)=>Math.floor(Math.random()*(b-a+1))+a;
const shuffle=arr=>{for(let i=arr.length-1;i>0;i--){let j=randInt(0,i);[arr[i],arr[j]]=[arr[j],arr[i]]}return arr;};
const hashQ=q=>btoa(unescape(encodeURIComponent(JSON.stringify(q))));

/* ===== Fun√ß√µes para gerar quest√µes ====== */
function genAlgebra(){const t=randInt(1,3);if(t===1){const x=randInt(1,12),a=randInt(1,12),m=x+a;return{area:'√Ålgebra',type:'linear',text:`Se x + ${a} = ${m}, ent√£o x = ?`,answer:x,explain:`x = ${m} - ${a} = ${x}`}}else if(t===2){const a=randInt(1,5),b=randInt(1,5),roots=[-a,-b];return{area:'√Ålgebra',type:'quadratica',text:`Se (x ${a>=0?'+':'-'} ${Math.abs(a)})¬∑(x ${b>=0?'+':'-'} ${Math.abs(b)}) = 0, uma raiz poss√≠vel √© ?`,answer:roots[randInt(0,1)],explain:`Ra√≠zes poss√≠veis: ${-a}, ${-b}`}}else{const x=randInt(1,12),n=2*x;return{area:'√Ålgebra',type:'linear2',text:`Se 2x = ${n}, ent√£o x = ?`,answer:x,explain:`x = ${n}/2 = ${x}`}}}
function genGeometria(){const t=randInt(1,3);if(t===1){const r=randInt(1,8),pi=level==='facil'?3:3.14,area=Number((pi*r*r).toFixed(2));return{area:'Geometria',type:'circulo',text:`√Årea de um c√≠rculo (œÄ‚âà${pi}) com raio ${r}?`,answer:area,explain:`A=œÄ¬∑r¬≤=${area}`,diagram:{type:'circle',r}}}else if(t===2){const b=randInt(2,12),h=randInt(1,10),area=Number((b*h/2).toFixed(2));return{area:'Geometria',type:'triangulo',text:`√Årea de tri√¢ngulo com base ${b} e altura ${h}?`,answer:area,explain:`A=(b¬∑h)/2=${area}`,diagram:{type:'triangle',b,h}}else{const a=randInt(3,12),b=randInt(3,12),hyp=Number(Math.sqrt(a*a+b*b).toFixed(2));return{area:'Geometria',type:'pyth',text:`Em tri√¢ngulo ret√¢ngulo com catetos ${a} e ${b}, a hipotenusa ‚âà ?`,answer:hyp,explain:`c=‚àö(a¬≤+b¬≤)=‚àö(${a*a}+${b*b})‚âà${hyp}`,diagram:{type:'rightTriangle',a,b}}}}
function genTrigonometria(){const angs=[0,30,45,60,90],vals={0:0,30:0.5,45:Math.SQRT2/2,60:Math.sqrt(3)/2,90:1},ang=angs[randInt(0,angs.length-1)];return{area:'Trigonometria',type:'seno',text:`sen(${ang}¬∞) ‚âà ?`,answer:Number(vals[ang].toFixed(2)),explain:`sen(${ang}¬∞) ‚âà ${Number(vals[ang].toFixed(2))}`}}
function genCalculo(){const t=randInt(1,2);if(t===1)return{area:'C√°lculo',type:'derivada',text:`d/dx (x¬≤) = ?`,answer:'2x',explain:'d/dx x^n = n¬∑x^(n-1)'};else{const n=randInt(1,4);return{area:'C√°lculo',type:'integral',text:`‚à´ x^${n} dx = ? (sem +C)`,answer:`x^${n+1}/${n+1}`,explain:`‚à´ x^n dx = x^(n+1)/(n+1)`}}}
function genEstatistica(){const nums=[randInt(0,9),randInt(0,9),randInt(0,9)],mean=Number(((nums[0]+nums[1]+nums[2])/3).toFixed(1));return{area:'Estat√≠stica',type:'media',text:`M√©dia de [${nums.join(', ')}] = ?`,answer:mean,explain:`Soma=${nums[0]+nums[1]+nums[2]}, m√©dia=${mean}`}}
function generateQuestion(area){let q;if(area==='√Ålgebra')q=genAlgebra();if(area==='Geometria')q=genGeometria();if(area==='Trigonometria')q=genTrigonometria();if(area==='C√°lculo')q=genCalculo();if(area==='Estat√≠stica')q=genEstatistica();let options=[];const ans=q.answer;if(typeof ans==='number'||!isNaN(Number(ans))){const numAns=Number(ans);if(level==='facil'){const base=Math.round(numAns);options=[base,base+1,base-1,base+2]}else if(level==='medio'){options=[numAns,numAns+randInt(1,4),Math.max(Math.round(numAns)-randInt(1,3),0),Math.round(numAns+randInt(-2,5))]}else{options=[numAns,Math.round(numAns+randInt(2,8)),Math.round(Math.max(numAns-randInt(2,6),0)),Math.round(numAns+randInt(-5,10))]}}else{options=[ans,'x','2','x¬≤','3']}options=shuffle(Array.from(new Set(options)).slice(0,5));if(!options.some(o=>String(o)===String(ans))){options[0]=ans;shuffle(options)}while(options.length<5){options.push(randInt(1,100));options=shuffle(Array.from(new Set(options)).slice(0,5))}q.options=options;return q}

/* ===== Fun√ß√µes de renderiza√ß√£o ====== */
function renderQuestion(q){currentQ=q;areaLabel.textContent=`√Årea: ${q.area}`;levelLabel.textContent=level;questionDiv.textContent=q.text;optionsDiv.innerHTML='';hintBox.style.display='none';diagramDiv.style.display='none';q.options.forEach(opt=>{const el=document.createElement('div');el.className='option';el.textContent=opt;el.onclick=()=>onAnswer(el,opt,q);optionsDiv.appendChild(el);});if(q.diagram)renderDiagram(q.diagram);}
function renderDiagram(diag){diagramDiv.innerHTML='';diagramDiv.style.display='flex';if(diag.type==='circle'){const r=diag.r,size=140;diagramDiv.innerHTML=`<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}"><circle cx="${size/2}" cy="${size/2}" r="${size/2-8}" stroke="var(--text-color)" stroke-opacity="0.2" fill="none" /><text x="${size/2}" y="${size/2}" fill="var(--accent)" font-size="12" text-anchor="middle" dominant-baseline="middle">r=${r}</text></svg>`;}else if(diag.type==='triangle'||diag.type==='rightTriangle'){const w=180,h=120;if(diag.type==='triangle'){const b=diag.b,hh=diag.h;diagramDiv.innerHTML=`<svg width="${w}" height="${h}" viewBox="0 0 ${w} ${h}"><polygon points="10,${h-10} ${w-10},${h-10} ${w/2},${h-10-hh}" fill="none" stroke="var(--accent)" stroke-opacity="0.25"/><text x="${w/2}" y="${h-8}" fill="var(--accent)" font-size="12" text-anchor="middle">base=${b}</text></svg>`;}else{const a=diag.a,b=diag.b;diagramDiv.innerHTML=`<svg width="${w}" height="${h}" viewBox="0 0 ${w} ${h}"><polyline points="20,${h-10} 20,20 ${w-20},${h-10}" fill="none" stroke="var(--accent)" stroke-opacity="0.25"/><text x="30" y="${h/2}" fill="var(--accent)" font-size="12">cateto=${a}</text><text x="${w-60}" y="${h-20}" fill="var(--accent)" font-size="12">cateto=${b}</text></svg>`;}}}
function onAnswer(el,choice,q){const correct=String(choice)===String(q.answer);stats[q.area].total++;if(correct){el.classList.add('correct');score+=10;stats[q.area].correct++;}else{el.classList.add('wrong');score=Math.max(score-5,0);}updateStats();const h=hashQ({text:q.text,options:q.options});recentHashes.push(h);if(recentHashes.length>RECENT_MAX)recentHashes.shift();setTimeout(()=>{if(level==='facil'&&stats[q.area].correct<easyTarget){}else{currentArea=(currentArea+1)%areas.length;}nextUniqueQuestion();},700);}
function nextUniqueQuestion(){let tries=0;const area=areas[currentArea];while(tries<120){const q=generateQuestion(area);const h=hashQ({text:q.text,options:q.options});if(!recentHashes.includes(h)){renderQuestion(q);return;}tries++;}renderQuestion(generateQuestion(area));}
function formatAreaStatsString(){const parts=[];for(const a of areas){const t=stats[a].total,c=stats[a].correct,pct=t?Math.round(c/t*100):0;parts.push(`${a}: ${c}/${t} (${pct}%)`);}return parts.join(' | ');}
function updateStats(){scoreLabel.textContent=`Pontua√ß√£o: ${score}`;const totalAll=areas.reduce((s,a)=>s+stats[a].total,0),correctAll=areas.reduce((s,a)=>s+stats[a].correct,0);progressLabel.textContent=`${correctAll} acertos / ${totalAll} tentativas (${totalAll?Math.round(correctAll/totalAll*100):0}%)`;areaStats.textContent=formatAreaStatsString();chart.innerHTML='';areas.forEach(a=>{const t=stats[a].total,c=stats[a].correct,pct=t?Math.round(c/t*100):0;const lab=document.createElement('div');lab.className='small';lab.textContent=`${a}: ${pct}%`;const bar=document.createElement('div');bar.className='bar';const fill=document.createElement('div');fill.className='bar-fill';fill.style.width=`${pct}%`;bar.appendChild(fill);chart.appendChild(lab);chart.appendChild(bar);});}

/* ===== Eventos ====== */
function setLevel(newLevel){level=newLevel;[facilBtn,medioBtn,difBtn].forEach(btn=>btn.classList.remove('active'));d(`${newLevel}Btn`).classList.add('active');nextUniqueQuestion();}
facilBtn.onclick=()=>setLevel('facil');medioBtn.onclick=()=>setLevel('medio');difBtn.onclick=()=>setLevel('dif');
let currentZoom=100;
zoomToggle.onclick=()=>{currentZoom=currentZoom===100?110:currentZoom===110?120:100;document.body.style.fontSize=`${currentZoom}%`;};
studyToggle.onclick=()=>{studyMode=!studyMode;studyPanel.style.display=studyMode?'block':'none';studyToggle.textContent=studyMode?'Modo Jogo':'Modo Estudo';};
clearOnlyErrors.onclick=()=>{score=0;recentHashes.length=0;areas.forEach(a=>stats[a]={total:0,correct:0});updateStats();nextUniqueQuestion();};
restartGame.onclick=()=>{score=0;recentHashes.length=0;areas.forEach(a=>stats[a]={total:0,correct:0});updateStats();setLevel('facil');};
explainBtn.onclick=()=>{if(currentQ){hintBox.textContent=currentQ.explain;hintBox.style.display='block';}};
nextBtn.onclick=()=>nextUniqueQuestion();
repeatBtn.onclick=()=>renderQuestion(currentQ);

/* ===== Inicializa√ß√£o ====== */
setLevel('facil');updateStats();
</script>
</body>
</html>
