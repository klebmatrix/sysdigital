<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üß† Neuro Game ‚Äì Multimatem√°tica (Final - Sem repeti√ß√µes/limpar erros)</title>
<style>
  :root{
    --bg1:#0f1224; --bg2:#131427; --card:#151628; --accent:#00e1ff; --accent2:#00ff8c;
    --muted:#bdbdbd; --good:#4caf50; --bad:#d32f2f;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:Inter, Poppins, "Segoe UI", Roboto, sans-serif;
    background:linear-gradient(135deg,var(--bg1),var(--bg2));
    color:#eef2f7; padding:20px;
  }
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  h1{margin:6px 0;color:var(--accent);text-shadow:0 0 12px rgba(0,225,255,0.08)}
  .controls{display:flex;gap:10px;align-items:center}
  button, .toggle{cursor:pointer;border:0;padding:8px 12px;border-radius:10px;background:#0b1220;color:#fff}
  button:hover{opacity:.95}
  .level-btn.active{background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#04101a}
  .container{display:grid;grid-template-columns:1fr 380px;gap:20px;margin-top:18px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:18px;border-radius:12px; box-shadow:0 6px 24px rgba(0,0,0,0.6)}
  .game-top{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
  #areaAtual{font-size:18px;font-weight:600;color:#dffcff}
  .question{font-size:26px;margin:14px 0;padding:14px;background:#0d1220;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
  .options{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
  .option{padding:12px;border-radius:10px;background:var(--card);border:2px solid rgba(255,255,255,0.03);cursor:pointer;text-align:center}
  .option:hover{transform:translateY(-3px);transition:all .14s}
  .correct{background:linear-gradient(90deg,#2b7a30,#4caf50);border-color:rgba(129,255,129,0.6)}
  .wrong{background:linear-gradient(90deg,#b83a3a,#d32f2f);border-color:rgba(255,117,117,0.6)}
  .meta{display:flex;gap:14px;align-items:center;flex-wrap:wrap}
  #score{font-weight:700}
  .stats{color:var(--muted);margin-top:10px;font-size:14px}
  #chart{margin-top:12px}
  .bar{height:12px;background:#10121a;border-radius:12px;margin:8px 0;overflow:hidden;border:1px solid rgba(255,255,255,0.02)}
  .bar-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));width:0;transition:width .4s}
  aside .card{position:sticky;top:16px}
  .study {font-size:14px;color:var(--muted);text-align:left;line-height:1.5}
  .small{font-size:13px;color:var(--muted)}
  .muted-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:6px 8px;border-radius:8px}
  .row{display:flex;gap:10px;align-items:center}
  .hint{margin-top:8px;background:#091020;padding:10px;border-radius:8px;border:1px dashed rgba(255,255,255,0.02);min-height:38px}
  .diagram {margin-top:12px; display:flex; justify-content:center;}
  .center{display:flex;justify-content:center;align-items:center}
  .muted-2{color:#98a0b3}
  .badge { background:rgba(255,255,255,0.04); padding:6px 8px; border-radius:8px; font-size:13px }
  @media(max-width:980px){.container{grid-template-columns:1fr;}}
</style>
</head>
<body>
<header>
  <div>
    <h1>üß† Neuro Game ‚Äì Multimatem√°tica</h1>
    <div class="small">Teste seu conhecimento: Painel de estudo </div>
  </div>

  <div class="controls">
    <div class="row">
      <button id="facilBtn" class="level-btn">F√°cil</button>
      <button id="medioBtn" class="level-btn">M√©dio</button>
      <button id="difBtn" class="level-btn">Dif√≠cil</button>
    </div>
    <button id="studyToggle" class="muted-btn">Modo Estudo</button>
    <button id="clearOnlyErrors" class="muted-btn">Limpar erros</button>
    <button id="restartGame" class="muted-btn">Reiniciar o simulado</button>
  </div>
</header>

<div class="container">
  <main class="card">
    <div class="game-top">
      <div id="areaAtual">√Årea: ‚Äî</div>
      <div class="meta">
        <div id="score" class="badge">Pontua√ß√£o: 0</div>
        <div id="progress" class="small muted-2">0 acertos / 0 tentativas (0%)</div>
      </div>
    </div>

    <div id="question" class="question">Clique em um n√≠vel para come√ßar</div>

    <div id="options" class="options"></div>

    <div class="row" style="margin-top:12px;justify-content:space-between">
      <div style="display:flex;gap:8px">
        <button id="nextBtn" class="muted-btn">Pr√≥ximo</button>
        <button id="repeatBtn" class="muted-btn">Repetir √°rea</button>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="explainBtn" class="muted-btn">Mostrar explica√ß√£o</button>
      </div>
    </div>

    <div id="hintBox" class="hint" style="display:none"></div>
    <div id="diagram" class="diagram" style="display:none"></div>

    <div class="stats">
      <div id="areaStats">Estat√≠sticas por √°rea: ‚Äî</div>
      <div id="recent" style="margin-top:6px" class="small muted-2">Perguntas recentes evitam repeti√ß√£o</div>
    </div>
  </main>

  <aside>
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:700">Painel de Estudo</div>
        <div class="small">F√≥rmulas essenciais (n√£o repetidas nas perguntas)</div>
      </div>

      <div id="studyPanel" class="study" style="margin-top:10px;display:none">
        <b>√Ålgebra</b>
        <div>- Equa√ß√£o quadr√°tica: x = (-b ¬± ‚àö(b¬≤-4ac)) / (2a)</div>
        <div>- Exemplo: para x + 5 = 12 ‚Üí x = 7</div>
        <hr>
        <b>Geometria</b>
        <div>- √Årea c√≠rculo: A = œÄ r¬≤</div>
        <div>- Tri√¢ngulo: A = (b¬∑h)/2</div>
        <hr>
        <b>Trigonometria</b>
        <div>- sen30 = 1/2, sen45 ‚âà ‚àö2/2 ‚âà 0.71, sen60 ‚âà ‚àö3/2 ‚âà 0.87</div>
        <hr>
        <b>C√°lculo</b>
        <div>- d/dx x¬≤ = 2x</div>
        <div>- ‚à´ x‚Åø dx = x‚Åø‚Å∫¬π/(n+1) + C</div>
        <hr>
        <b>Estat√≠stica</b>
        <div>- M√©dia = soma / n</div>
        <div>- Moda: valor mais frequente; Mediana: valor central</div>
      </div>

      <div id="chart" style="margin-top:12px"></div>

      <div style="margin-top:12px">
        <div class="small">N√≠vel atual: <span id="levelLabel">‚Äî</span></div>
        <div style="margin-top:6px" class="small">Alvo (f√°cil): <span id="easyTarget">3</span> acertos por √°rea</div>
      </div>

      <div style="margin-top:12px" class="footer-note small muted-2">Nota: explica√ß√µes aparecem apenas quando voc√™ clicar em ‚ÄúMostrar explica√ß√£o‚Äù.</div>
    </div>
  </aside>
</div>

<script>
/* ====== State & Config ====== */
const areas = ["√Ålgebra","Geometria","Trigonometria","C√°lculo","Estat√≠stica"];
let currentArea = 0;
let level = 'facil';
let score = 0;
const stats = {};
const recentHashes = [];
const RECENT_MAX = 60;
const easyTarget = 3;
let currentQ = null;
let studyMode = false;

areas.forEach(a => stats[a] = { total:0, correct:0 });

/* ====== Utils ====== */
const randInt = (a,b) => Math.floor(Math.random()*(b-a+1))+a;
const shuffle = (arr) => { for(let i=arr.length-1;i>0;i--){const j=randInt(0,i);[arr[i],arr[j]]=[arr[j],arr[i]]} return arr; };
const hashQ = q => btoa(unescape(encodeURIComponent(JSON.stringify(q))));

/* ====== DOM Refs ====== */
const d = id => document.getElementById(id);
const questionDiv = d('question'), optionsDiv = d('options'), areaLabel = d('areaAtual');
const scoreLabel = d('score'), progressLabel = d('progress'), chart = d('chart'), areaStats = d('areaStats');
const hintBox = d('hintBox'), diagramDiv = d('diagram'), studyPanel = d('studyPanel');
const facilBtn = d('facilBtn'), medioBtn = d('medioBtn'), difBtn = d('difBtn');
const studyToggle = d('studyToggle'), clearOnlyErrors = d('clearOnlyErrors'), explainBtn = d('explainBtn');
const nextBtn = d('nextBtn'), repeatBtn = d('repeatBtn'), levelLabel = d('levelLabel');
const restartGame = d('restartGame');

/* ====== Generators (like before, explanations stored but not shown in question) ====== */
function genAlgebra(){
  const t = randInt(1,3);
  if(t===1){
    const x = randInt(1,12);
    const add = randInt(1,12);
    const m = x + add;
    return {area:'√Ålgebra',type:'linear',text:`Se x + ${add} = ${m}, ent√£o x = ?`,answer:x,explain:`Subtraia ${add} dos dois lados: x = ${m} - ${add} = ${x}`};
  } else if(t===2){
    const a = randInt(1,5);
    const b = randInt(1,5);
    const roots = [-a,-b];
    return {area:'√Ålgebra',type:'quadratica',text:`Se (x ${a>=0?'+':'-'} ${Math.abs(a)})¬∑(x ${b>=0?'+':'-'} ${Math.abs(b)}) = 0, uma raiz poss√≠vel √© ?`,answer:roots[randInt(0,1)],explain:`As ra√≠zes poss√≠veis s√£o ${-a} e ${-b}`};
  } else {
    const x = randInt(1,12);
    const n = 2*x;
    return {area:'√Ålgebra',type:'linear2',text:`Se 2x = ${n}, ent√£o x = ?`,answer:x,explain:`Divida por 2: x = ${n}/2 = ${x}`};
  }
}

function genGeometria(){
  const t = randInt(1,3);
  if(t===1){
    const r = randInt(1,8);
    const approxPi = level==='facil'?3:3.14;
    const area = Number((approxPi * r * r).toFixed(2));
    return {area:'Geometria',type:'circulo',text:`√Årea de um c√≠rculo (œÄ‚âà${approxPi}) com raio ${r}?`,answer:area,explain:`A = œÄ r¬≤ = ${approxPi}¬∑${r}¬≤ = ${area}`,diagram:{type:'circle',r}};
  } else if(t===2){
    const b = randInt(2,12), h = randInt(1,10);
    const area = Number(((b*h)/2).toFixed(2));
    return {area:'Geometria',type:'triangulo',text:`√Årea de tri√¢ngulo com base ${b} e altura ${h}?`,answer:area,explain:`A=(b¬∑h)/2 = (${b}¬∑${h})/2 = ${area}`,diagram:{type:'triangle',b,h}};
  } else {
    const a = randInt(3,12), b = randInt(3,12);
    const hyp = Number(Math.sqrt(a*a+b*b).toFixed(2));
    return {area:'Geometria',type:'pyth',text:`Em tri√¢ngulo ret√¢ngulo com catetos ${a} e ${b}, a hipotenusa ‚âà ?`,answer:hyp,explain:`c = ‚àö(a¬≤+b¬≤) = ‚àö(${a*a}+${b*b}) ‚âà ${hyp}`,diagram:{type:'rightTriangle',a,b}};
  }
}

function genTrigonometria(){
  const angles = [0,30,45,60,90];
  const sinVals = {0:0,30:0.5,45:Math.SQRT2/2,60:Math.sqrt(3)/2,90:1};
  const ang = angles[randInt(0,angles.length-1)];
  return {area:'Trigonometria',type:'seno',text:`sen(${ang}¬∞) ‚âà ?`,answer:Number(sinVals[ang].toFixed(2)),explain:`Valor conhecido: sen(${ang}¬∞) ‚âà ${Number(sinVals[ang].toFixed(2))}`};
}

function genCalculo(){
  const t = randInt(1,2);
  if(t===1){
    return {area:'C√°lculo',type:'derivada',text:`d/dx (x¬≤) = ?`,answer:'2x',explain:'Regra da pot√™ncia: d/dx x^n = n¬∑x^(n-1)'};
  } else {
    const n = randInt(1,4);
    return {area:'C√°lculo',type:'integral',text:`‚à´ x^${n} dx = ? (sem +C)`,answer:`x^${n+1}/${n+1}`,explain:`Regra: ‚à´ x^n dx = x^(n+1)/(n+1)`};
  }
}

function genEstatistica(){
  const nums = [randInt(0,9), randInt(0,9), randInt(0,9)];
  const mean = Number(((nums[0]+nums[1]+nums[2])/3).toFixed(1));
  return {area:'Estat√≠stica',type:'media',text:`M√©dia de [${nums.join(', ')}] = ?`,answer:mean,explain:`Soma = ${nums[0]+nums[1]+nums[2]}, m√©dia = ${mean}`};
}

function generateQuestion(area){
  let q;
  if(area==='√Ålgebra') q = genAlgebra();
  if(area==='Geometria') q = genGeometria();
  if(area==='Trigonometria') q = genTrigonometria();
  if(area==='C√°lculo') q = genCalculo();
  if(area==='Estat√≠stica') q = genEstatistica();

  // montar op√ß√µes (respostas)
  let options = [];
  const ans = q.answer;
  if(typeof ans === 'number' || !isNaN(Number(ans))){
    const numAns = Number(ans);
    if(level==='facil'){
      const base = Math.round(numAns);
      options = [base, base+1, base-1, base+2];
    } else if(level==='medio'){
      options = [numAns, numAns + randInt(1,4), Math.max(Math.round(numAns)-randInt(1,3),0), Math.round(numAns+randInt(-2,5))];
    } else {
      options = [numAns, Math.round(numAns+randInt(2,8)), Math.round(Math.max(numAns-randInt(2,6),0)), Math.round(numAns+randInt(-5,10))];
    }
  } else {
    options = [ans, 'x', '2', 'x¬≤'];
  }

  options = shuffle(Array.from(new Set(options)).slice(0,4));
  if(!options.some(o => String(o)===String(ans))) { options[0] = ans; shuffle(options); }
  q.options = options;
  return q;
}

/* ====== Render & Interaction (explanations only on demand) ====== */
function renderQuestion(q){
  currentQ = q;
  areaLabel.textContent = `√Årea: ${q.area}`;
  levelLabel.textContent = level;
  questionDiv.textContent = q.text; // no explanation injected here
  optionsDiv.innerHTML = '';
  hintBox.style.display='none';
  diagramDiv.style.display='none';
  q.options.forEach(opt=>{
    const el = document.createElement('div');
    el.className='option';
    el.textContent=opt;
    el.onclick = ()=>onAnswer(el,opt,q);
    optionsDiv.appendChild(el);
  });
  if(q.diagram) renderDiagram(q.diagram);
}

function renderDiagram(diag){
  diagramDiv.innerHTML = '';
  diagramDiv.style.display='flex';
  if(diag.type==='circle'){
    const r = diag.r;
    const size = 140;
    const svg = `<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
      <circle cx="${size/2}" cy="${size/2}" r="${size/2 - 8}" stroke="white" stroke-opacity="0.2" fill="none" />
      <text x="${size/2}" y="${size/2}" fill="#bfeeff" font-size="12" text-anchor="middle" dominant-baseline="middle">r=${r}</text>
    </svg>`;
    diagramDiv.innerHTML = svg;
  } else if(diag.type==='triangle' || diag.type==='rightTriangle'){
    const w = 180, h = 120;
    if(diag.type==='triangle'){
      const b = diag.b, hh = diag.h;
      const svg = `<svg width="${w}" height="${h}" viewBox="0 0 ${w} ${h}">
        <polygon points="10,${h-10} ${w-10},${h-10} ${w/2},${h-10-hh}" fill="none" stroke="#bfeeff" stroke-opacity="0.25"/>
        <text x="${w/2}" y="${h-8}" fill="#bfeeff" font-size="12" text-anchor="middle">base=${b}</text>
      </svg>`;
      diagramDiv.innerHTML = svg;
    } else {
      const a = diag.a, b = diag.b;
      const svg = `<svg width="${w}" height="${h}" viewBox="0 0 ${w} ${h}">
        <polyline points="20,${h-10} 20,20 ${w-20},${h-10}" fill="none" stroke="#bfeeff" stroke-opacity="0.25"/>
        <text x="30" y="${h/2}" fill="#bfeeff" font-size="12">cateto=${a}</text>
        <text x="${w-60}" y="${h-20}" fill="#bfeeff" font-size="12">cateto=${b}</text>
      </svg>`;
      diagramDiv.innerHTML = svg;
    }
  }
}

function onAnswer(el,choice,q){
  const correct = String(choice) === String(q.answer);
  stats[q.area].total++;
  if(correct){
    el.classList.add('correct'); score+=10; stats[q.area].correct++;
  } else {
    el.classList.add('wrong'); score=Math.max(score-5,0);
  }
  updateStats();
  // add to recent to avoid repetition
  const h = hashQ({text:q.text,options:q.options});
  recentHashes.push(h); if(recentHashes.length>RECENT_MAX) recentHashes.shift();

  // after delay go next (in easy stay until target)
  setTimeout(()=>{
    if(level==='facil' && stats[q.area].correct < easyTarget){
      // stay same area
    } else {
      currentArea = (currentArea + 1) % areas.length;
    }
    nextUniqueQuestion();
  },700);
}

/* ====== Repetition control ====== */
function nextUniqueQuestion(){
  let tries = 0;
  const area = areas[currentArea];
  while(tries < 120){
    const q = generateQuestion(area);
    const h = hashQ({text:q.text,options:q.options});
    if(!recentHashes.includes(h)){
      renderQuestion(q);
      return;
    }
    tries++;
  }
  // fallback
  renderQuestion(generateQuestion(area));
}

/* ====== Stats display (formatted like you provided) ====== */
function formatAreaStatsString(){
  const parts = [];
  for(const a of areas){
    const t = stats[a].total, c = stats[a].correct;
    const pct = t? Math.round(c/t*100) : 0;
    parts.push(`${a}: ${c}/${t} (${pct}%)`);
  }
  return parts.join(' | ');
}

function updateStats(){
  scoreLabel.textContent = `Pontua√ß√£o: ${score}`;
  const totalAll = areas.reduce((s,a)=> s + stats[a].total, 0);
  const correctAll = areas.reduce((s,a)=> s + stats[a].correct, 0);
  progressLabel.textContent = `${correctAll} acertos / ${totalAll} tentativas (${ totalAll? Math.round(correctAll/totalAll*100):0 }%)`;
  areaStats.textContent = formatAreaStatsString();
  // chart
  chart.innerHTML = '';
  areas.forEach(a=>{
    const t=stats[a].total, c=stats[a].correct;
    const pct = t?Math.round(c/t*100):0;
    const lab = document.createElement('div'); lab.className='small'; lab.textContent = `${a}: ${pct}%`;
    const bar = document.createElement('div'); bar.className='bar';
    const fill = document.createElement('div'); fill.className='bar-fill'; fill.style.width = pct + '%';
    bar.appendChild(fill);
    chart.appendChild(lab); chart.appendChild(bar);
  });
}

/* ====== Controls ====== */
function setActiveLevelBtn(){
  [facilBtn,medioBtn,difBtn].forEach(b=>b.classList.remove('active'));
  if(level==='facil') facilBtn.classList.add('active');
  if(level==='medio') medioBtn.classList.add('active');
  if(level==='dificil') difBtn.classList.add('active');
  levelLabel.textContent = level;
}

facilBtn.onclick = ()=>{ level='facil'; setActiveLevelBtn(); nextUniqueQuestion(); };
medioBtn.onclick = ()=>{ level='medio'; setActiveLevelBtn(); nextUniqueQuestion(); };
difBtn.onclick = ()=>{ level='dificil'; setActiveLevelBtn(); nextUniqueQuestion(); };

studyToggle.onclick = ()=>{
  studyMode = !studyMode;
  studyPanel.style.display = studyMode? 'block':'none';
  studyToggle.textContent = studyMode? 'Modo Estudo: On' : 'Modo Estudo';
};

// NEW: Limpar apenas erros e continuar
clearOnlyErrors.onclick = ()=>{
  // For each area: keep correct count, set total = correct (so errors become zero)
  for(const a of areas){
    stats[a].total = stats[a].correct;
  }
  // Do not change score or correct counts
  updateStats();
  showTempMessage('Erros limpos ‚Äî mantendo seus acertos',1400);
};

explainBtn.onclick = ()=>{
  if(currentQ && currentQ.explain){
    hintBox.style.display='block';
    hintBox.textContent = currentQ.explain;
  } else {
    hintBox.style.display='block';
    hintBox.textContent = 'Explica√ß√£o n√£o dispon√≠vel para esta pergunta.';
  }
};

nextBtn.onclick = ()=>{ currentArea = (currentArea + 1) % areas.length; nextUniqueQuestion(); };
repeatBtn.onclick = ()=> nextUniqueQuestion();

restartGame.onclick = ()=>{
  if(confirm('Reiniciar jogo e limpar todo o progresso?')){
    for(const a of areas){ stats[a].total=0; stats[a].correct=0; }
    score = 0; recentHashes.length = 0; currentArea = 0; level='facil';
    setActiveLevelBtn(); updateStats(); nextUniqueQuestion();
    showTempMessage('Jogo reiniciado',1400);
  }
};

/* ====== Small helpers ====== */
function showTempMessage(text,ms=1500){
  const el = document.createElement('div');
  el.style.position='fixed'; el.style.left='50%'; el.style.top='14px'; el.style.transform='translateX(-50%)';
  el.style.background='rgba(0,0,0,0.6)'; el.style.padding='10px 16px'; el.style.borderRadius='10px'; el.style.zIndex=9999;
  el.style.border='1px solid rgba(255,255,255,0.03)'; el.textContent = text;
  document.body.appendChild(el); setTimeout(()=> el.remove(), ms);
}

/* ====== Start ====== */
setActiveLevelBtn();
updateStats();
nextUniqueQuestion();

</script>
Doar Pix :  <h3>914e4b6a-91b4-4e50-bb7c-c610dc90407a</h3>
</body>
</html>
